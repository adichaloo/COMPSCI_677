Peer 0 is assigned as the leader (trader).
Peer 0 is assigned as the leader (trader).
No existing market state found. Starting with empty inventory.
[0] Market state loaded from disk.
Network structure initialized (Fully Connected):
Peer 0 (leader) connected to peers [1, 2]
Peer 1 (buyer) connected to peers [0, 2]
Peer 2 (seller) connected to peers [0, 1]
Peer 0 (leader) with item None listening on port 5000...
Peer 1 (buyer) with item None listening on port 5001...
Peer 2 (seller) with item fish listening on port 5002...
Seller 2 is sending its inventory for fish
[2] Incremented vector clock: [0, 0, 1]
[2] Sending UpdateInventoryMessage to leader 0:
    Seller ID: 2
    Address: ('localhost', 5002)
    Product Name: fish
    Stock: 10
    Vector Clock: [0, 0, 1]
Inventory Established with Leader
[2] Sent inventory update to leader [0]
[0] Updated vector clock from [0, 0, 0] to [1, 0, 1] after receiving [0, 0, 1]
[0] Updated inventory with seller 2 for product fish
Inventory saved to disk.
[0] Market state saved to disk.
[0] Current Inventory:
    Product: fish
        Seller 2: Stock 10, Address ('localhost', 5002), Vector Clock [0, 0, 1]
Buyer 1 is initiating a buy for salt (Quantity: 3)
[1] Incremented vector clock: [0, 1, 0]
20.11.2024 21:09:55.724 [1] Initiating buy with trader for salt
[0] Updated vector clock from [1, 0, 1] to [2, 1, 1] after receiving [0, 1, 0]
Error: Item 'salt' not found or out of stock.
[0] Could not fulfill the order for buyer 1.
[1] Updated vector clock from [0, 1, 0] to [2, 2, 1] after receiving [2, 1, 1]
[1] Purchase of salt from trader failed.
[1] Buyer will try a different item in 6 seconds.
Buyer 1 is initiating a buy for fish (Quantity: 3)
[1] Incremented vector clock: [2, 3, 1]
20.11.2024 21:10:00.730 [1] Initiating buy with trader for fish
[0] Updated vector clock from [2, 1, 1] to [3, 3, 1] after receiving [2, 3, 1]
Stock reduced: 3 units of 'fish' sold by 2 (('localhost', 5002)).
[0] Sold item to buyer 1.
[1] Updated vector clock from [2, 3, 1] to [3, 4, 1] after receiving [3, 3, 1]
20.11.2024 21:10:00.749 [1] bought 3 fish(s) from trader.
[1] Updated vector clock from [3, 4, 1] to [3, 5, 1] after receiving [3, 3, 1]
[1] Buyer will make another purchase in 9 seconds.
[2] Updated vector clock from [0, 0, 1] to [3, 3, 2] after receiving [3, 3, 1]
[2] Updated vector clock from [3, 3, 2] to [3, 3, 3] after receiving [3, 3, 1]
[2] Received payment of 27.0 for selling 3 fish(s). Total earnings: 27.0
[1] Incremented vector clock: [3, 6, 1]
20.11.2024 21:10:01.732 [1] Initiating buy with trader for fish
[0] Updated vector clock from [3, 3, 1] to [4, 6, 1] after receiving [3, 6, 1]
Stock reduced: 5 units of 'fish' sold by 2 (('localhost', 5002)).
[0] Sold item to buyer 1.
[1] Updated vector clock from [3, 6, 1] to [4, 7, 1] after receiving [4, 6, 1]
20.11.2024 21:10:01.757 [1] bought 5 fish(s) from trader.
[1] Updated vector clock from [4, 7, 1] to [4, 8, 1] after receiving [4, 6, 1]
[1] Buyer will make another purchase in 7 seconds.
[2] Updated vector clock from [3, 3, 3] to [4, 6, 4] after receiving [4, 6, 1]
[2] Updated vector clock from [4, 6, 4] to [4, 6, 5] after receiving [4, 6, 1]
[2] Received payment of 45.0 for selling 5 fish(s). Total earnings: 72.0
[1] Incremented vector clock: [4, 9, 1]
20.11.2024 21:10:08.762 [1] Initiating buy with trader for fish
[0] Updated vector clock from [4, 6, 1] to [5, 9, 1] after receiving [4, 9, 1]
Stock reduced: 1 units of 'fish' sold by 2 (('localhost', 5002)).
[0] Sold item to buyer 1.
[1] Updated vector clock from [4, 9, 1] to [5, 10, 1] after receiving [5, 9, 1]
20.11.2024 21:10:08.784 [1] bought 1 fish(s) from trader.
[1] Updated vector clock from [5, 10, 1] to [5, 11, 1] after receiving [5, 9, 1]
[1] Buyer will make another purchase in 9 seconds.
[2] Updated vector clock from [4, 6, 5] to [5, 9, 6] after receiving [5, 9, 1]
[2] Updated vector clock from [5, 9, 6] to [5, 9, 7] after receiving [5, 9, 1]
[2] Received payment of 9.0 for selling 1 fish(s). Total earnings: 81.0
[1] Incremented vector clock: [5, 12, 1]
20.11.2024 21:10:09.755 [1] Initiating buy with trader for salt
[0] Updated vector clock from [5, 9, 1] to [6, 12, 1] after receiving [5, 12, 1]
Error: Item 'salt' not found or out of stock.
[0] Could not fulfill the order for buyer 1.
[1] Updated vector clock from [5, 12, 1] to [6, 13, 1] after receiving [6, 12, 1]
[1] Purchase of salt from trader failed.
[1] Buyer will try a different item in 10 seconds.
Buyer 1 is initiating a buy for fish (Quantity: 3)
[1] Incremented vector clock: [6, 14, 1]
20.11.2024 21:10:10.734 [1] Initiating buy with trader for fish
[0] Updated vector clock from [6, 12, 1] to [7, 14, 1] after receiving [6, 14, 1]
Error: No seller has enough stock of 'fish'.
[0] Could not fulfill the order for buyer 1.
[1] Updated vector clock from [6, 14, 1] to [7, 15, 1] after receiving [7, 14, 1]
[1] Purchase of fish from trader failed.
[1] Buyer will try a different item in 7 seconds.
[Leader 0] Leader failed with probability 0.8.
Leader 0 has failed. Initiating new election.
Peer 0 is initiating the election.
[0] Initiating election...
[1] Updated vector clock from [7, 15, 1] to [7, 16, 1] after receiving [7, 14, 1]
[1] Received election message from 0.
[1] Sending OK message to 0.
[2] Updated vector clock from [5, 9, 7] to [7, 14, 8] after receiving [7, 14, 1]
[2] Received election message from 0.
[1] Initiating election...
[0] Updated vector clock from [7, 14, 1] to [8, 16, 1] after receiving [7, 16, 1]
[0] Received OK message from 1.
[2] Updated vector clock from [7, 14, 8] to [7, 16, 9] after receiving [7, 16, 1]
[2] Received election message from 1.
[2] Sending OK message to 0.
[2] Initiating election...
[2] Sending OK message to 1.
[0] Updated vector clock from [8, 16, 1] to [9, 16, 9] after receiving [7, 16, 9]
[0] Received OK message from 2.
[1] Updated vector clock from [7, 16, 1] to [7, 17, 9] after receiving [7, 16, 9]
[1] Received OK message from 2.
[1] OK response received or not eligible. Election process will continue.
[0] OK response received or not eligible. Election process will continue.
[2] No OK response received. Declaring self as leader.
[2] Declaring itself as the new leader.
Inventory loaded from disk.
[2] Market state loaded from disk.
[0] Updated vector clock from [9, 16, 9] to [10, 16, 9] after receiving [7, 16, 9]
[0] New leader announced: 2.
[0] Updated leader to Peer 2.
[1] Updated vector clock from [7, 17, 9] to [7, 18, 9] after receiving [7, 16, 9]
[1] New leader announced: 2.
[1] Updated leader to Peer 2.
Election ended. New leader is Peer 2.
[1] Incremented vector clock: [7, 19, 9]
20.11.2024 21:10:17.790 [1] Initiating buy with trader for boar
[2] Updated vector clock from [7, 16, 9] to [7, 19, 10] after receiving [7, 19, 9]
[1] Incremented vector clock: [7, 20, 9]
20.11.2024 21:10:17.793 [1] Initiating buy with trader for fish
[2] Updated vector clock from [7, 19, 10] to [7, 20, 11] after receiving [7, 20, 9]
Error: Item 'boar' not found or out of stock.
[2] Could not fulfill the order for buyer 1.
Stock reduced: 5 units of 'fish' sold by 2 (('localhost', 5002)).
[2] Sold item to buyer 1.
[1] Updated vector clock from [7, 20, 9] to [7, 21, 11] after receiving [7, 20, 11]
20.11.2024 21:10:18.752 [1] bought 5 fish(s) from trader.
[1] Updated vector clock from [7, 21, 11] to [7, 22, 11] after receiving [7, 20, 11]
[1] Buyer will make another purchase in 8 seconds.
[1] Updated vector clock from [7, 22, 11] to [7, 23, 11] after receiving [7, 20, 11]
[1] Purchase of boar from trader failed.
[1] Buyer will try a different item in 5 seconds.
[2] Updated vector clock from [7, 20, 11] to [7, 20, 12] after receiving [7, 20, 11]
[2] Updated vector clock from [7, 20, 12] to [7, 20, 13] after receiving [7, 20, 11]
[2] Received payment of 45.0 for selling 5 fish(s). Total earnings: 131.0
[2] Stock reached 0. Restocking fish and sending update to leader.
[2] Incremented vector clock: [7, 20, 14]
[2] Sending UpdateInventoryMessage to leader 2:
    Seller ID: 2
    Address: ('localhost', 5002)
    Product Name: fish
    Stock: 10
    Vector Clock: [7, 20, 14]
[2] Sent inventory update to leader [2]
[2] Updated vector clock from [7, 20, 14] to [7, 20, 15] after receiving [7, 20, 14]
[2] Updated inventory with seller 2 for product fish
Inventory saved to disk.
[2] Market state saved to disk.
[2] Current Inventory:
    Product: fish
        Seller 2: Stock 15, Address ('localhost', 5002), Vector Clock [7, 20, 14]
Buyer 1 is initiating a buy for boar (Quantity: 1)
[1] Incremented vector clock: [7, 24, 11]
20.11.2024 21:10:19.739 [1] Initiating buy with trader for boar
[2] Updated vector clock from [7, 20, 15] to [7, 24, 16] after receiving [7, 24, 11]
Error: Item 'boar' not found or out of stock.
[2] Could not fulfill the order for buyer 1.
[1] Updated vector clock from [7, 24, 11] to [7, 25, 16] after receiving [7, 24, 16]
[1] Purchase of boar from trader failed.
[1] Buyer will try a different item in 8 seconds.
[1] Incremented vector clock: [7, 26, 16]
20.11.2024 21:10:19.786 [1] Initiating buy with trader for salt
[2] Updated vector clock from [7, 24, 16] to [7, 26, 17] after receiving [7, 26, 16]
Error: Item 'salt' not found or out of stock.
[2] Could not fulfill the order for buyer 1.
[1] Updated vector clock from [7, 26, 16] to [7, 27, 17] after receiving [7, 26, 17]
[1] Purchase of salt from trader failed.
[1] Buyer will try a different item in 5 seconds.
[1] Incremented vector clock: [7, 28, 17]
20.11.2024 21:10:23.757 [1] Initiating buy with trader for boar
[2] Updated vector clock from [7, 26, 17] to [7, 28, 18] after receiving [7, 28, 17]
Error: Item 'boar' not found or out of stock.
[2] Could not fulfill the order for buyer 1.
[1] Updated vector clock from [7, 28, 17] to [7, 29, 18] after receiving [7, 28, 18]
[1] Purchase of boar from trader failed.
[1] Buyer will try a different item in 6 seconds.
[1] Incremented vector clock: [7, 30, 18]
20.11.2024 21:10:25.767 [1] Initiating buy with trader for salt
[2] Updated vector clock from [7, 28, 18] to [7, 30, 19] after receiving [7, 30, 18]
Error: Item 'salt' not found or out of stock.
[2] Could not fulfill the order for buyer 1.
[1] Updated vector clock from [7, 30, 18] to [7, 31, 19] after receiving [7, 30, 19]
[1] Purchase of salt from trader failed.
[1] Buyer will try a different item in 10 seconds.
[1] Incremented vector clock: [7, 32, 19]
20.11.2024 21:10:26.753 [1] Initiating buy with trader for boar
[2] Updated vector clock from [7, 30, 19] to [7, 32, 20] after receiving [7, 32, 19]
Error: Item 'boar' not found or out of stock.
[2] Could not fulfill the order for buyer 1.
[1] Updated vector clock from [7, 32, 19] to [7, 33, 20] after receiving [7, 32, 20]
[1] Purchase of boar from trader failed.
[1] Buyer will try a different item in 10 seconds.
[1] Incremented vector clock: [7, 34, 20]
20.11.2024 21:10:27.759 [1] Initiating buy with trader for salt
[2] Updated vector clock from [7, 32, 20] to [7, 34, 21] after receiving [7, 34, 20]
Error: Item 'salt' not found or out of stock.
[2] Could not fulfill the order for buyer 1.
[1] Updated vector clock from [7, 34, 20] to [7, 35, 21] after receiving [7, 34, 21]
[1] Purchase of salt from trader failed.
[1] Buyer will try a different item in 8 seconds.
Buyer 1 is initiating a buy for fish (Quantity: 1)
[1] Incremented vector clock: [7, 36, 21]
20.11.2024 21:10:29.745 [1] Initiating buy with trader for fish
[2] Updated vector clock from [7, 34, 21] to [7, 36, 22] after receiving [7, 36, 21]
[1] Incremented vector clock: [7, 37, 21]
20.11.2024 21:10:29.782 [1] Initiating buy with trader for fish
[2] Updated vector clock from [7, 36, 22] to [7, 37, 23] after receiving [7, 37, 21]
Stock reduced: 1 units of 'fish' sold by 2 (('localhost', 5002)).
[2] Sold item to buyer 1.
Stock reduced: 1 units of 'fish' sold by 2 (('localhost', 5002)).
[2] Sold item to buyer 1.
[1] Updated vector clock from [7, 37, 21] to [7, 38, 23] after receiving [7, 37, 23]
20.11.2024 21:10:29.795 [1] bought 1 fish(s) from trader.
[1] Updated vector clock from [7, 38, 23] to [7, 39, 23] after receiving [7, 37, 23]
[1] Updated vector clock from [7, 39, 23] to [7, 40, 23] after receiving [7, 37, 23]
20.11.2024 21:10:29.795 [1] bought 1 fish(s) from trader.
[1] Updated vector clock from [7, 40, 23] to [7, 41, 23] after receiving [7, 37, 23]
[1] Buyer will make another purchase in 10 seconds.
[1] Buyer will make another purchase in 7 seconds.
[2] Updated vector clock from [7, 37, 23] to [7, 37, 24] after receiving [7, 37, 23]
[2] Updated vector clock from [7, 37, 24] to [7, 37, 25] after receiving [7, 37, 23]
[2] Received payment of 9.0 for selling 1 fish(s). Total earnings: 142.0
[2] Updated vector clock from [7, 37, 25] to [7, 37, 26] after receiving [7, 37, 23]
[2] Updated vector clock from [7, 37, 26] to [7, 37, 27] after receiving [7, 37, 23]
[2] Received payment of 9.0 for selling 1 fish(s). Total earnings: 151.0
